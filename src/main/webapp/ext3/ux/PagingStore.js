Ext.ns("Ext.ux.data");Ext.ux.data.PagingStore=Ext.extend(Ext.data.Store,{destroy:function(){if(this.storeId||this.id){Ext.StoreMgr.unregister(this);}delete this.data;delete this.allData;delete this.snapshot;this.purgeListeners();},add:function(b){b=[].concat(b);if(b.length<1){return;}for(var d=0,a=b.length;d<a;d++){b[d].join(this);}var c=this.data.length;this.data.addAll(b);if(this.allData){this.allData.addAll(b);}if(this.snapshot){this.snapshot.addAll(b);}this.fireEvent("add",this,b,c);},remove:function(a){var b=this.data.indexOf(a);this.data.removeAt(b);if(this.allData){this.allData.remove(a);}if(this.snapshot){this.snapshot.remove(a);}if(this.pruneModifiedRecords){this.modified.remove(a);}this.fireEvent("remove",this,a,b);},removeAll:function(){this.data.clear();if(this.allData){this.allData.clear();}if(this.snapshot){this.snapshot.clear();}if(this.pruneModifiedRecords){this.modified=[];}this.fireEvent("clear",this);},insert:function(c,b){b=[].concat(b);for(var d=0,a=b.length;d<a;d++){this.data.insert(c,b[d]);b[d].join(this);}if(this.allData){this.allData.addAll(b);}if(this.snapshot){this.snapshot.addAll(b);}this.fireEvent("add",this,b,c);},getById:function(a){return(this.snapshot||this.allData||this.data).key(a);},load:function(b){b=b||{};if(this.fireEvent("beforeload",this,b)!==false){this.storeOptions(b);var c=Ext.apply({},b.params,this.baseParams);if(this.sortInfo&&this.remoteSort){var a=this.paramNames;c[a["sort"]]=this.sortInfo.field;c[a["dir"]]=this.sortInfo.direction;}if(this.isPaging(c)){(function(){if(this.allData){this.data=this.allData;delete this.allData;}this.applyPaging();this.fireEvent("datachanged",this);var d=[].concat(this.data.items);this.fireEvent("load",this,d,b);if(b.callback){b.callback.call(b.scope||this,d,b,true);}}).defer(1,this);return true;}this.proxy.load(c,this.reader,this.loadRecords,this,b);return true;}else{return false;}},loadRecords:function(g,b,f){if(!g||f===false){if(f!==false){this.fireEvent("load",this,[],b);}if(b.callback){b.callback.call(b.scope||this,[],b,false);}return;}var e=g.records,d=g.totalRecords||e.length;if(!b||b.add!==true){if(this.pruneModifiedRecords){this.modified=[];}for(var c=0,a=e.length;c<a;c++){e[c].join(this);}if(this.allData){this.data=this.allData;delete this.allData;}if(this.snapshot){this.data=this.snapshot;delete this.snapshot;}this.data.clear();this.data.addAll(e);this.totalLength=d;this.applySort();if(!this.allData){this.applyPaging();}if(e.length!=this.getCount()){e=[].concat(this.data.items);}this.fireEvent("datachanged",this);}else{this.totalLength=Math.max(d,this.data.length+e.length);this.add(e);}this.fireEvent("load",this,e,b);if(b.callback){b.callback.call(b.scope||this,e,b,true);}},loadData:function(c,a){this.isPaging(Ext.apply({},this.lastOptions?this.lastOptions.params:null,this.baseParams));var b=this.reader.readRecords(c);this.loadRecords(b,{add:a},true);},getTotalCount:function(){return this.allData?this.allData.getCount():this.totalLength||0;},filterBy:function(b,a){this.snapshot=this.snapshot||this.allData||this.data;delete this.allData;this.data=this.queryBy(b,a||this);this.applyPaging();this.fireEvent("datachanged",this);},queryBy:function(b,a){var c=this.snapshot||this.allData||this.data;return c.filterBy(b,a||this);},collect:function(h,j,b){var g=(b===true?this.snapshot||this.allData||this.data:this.data).items;var k,m,a=[],c={};for(var e=0,f=g.length;e<f;e++){k=g[e].data[h];m=String(k);if((j||!Ext.isEmpty(k))&&!c[m]){c[m]=true;a[a.length]=k;}}return a;},clearFilter:function(a){if(this.isFiltered()){this.data=this.snapshot;delete this.allData;delete this.snapshot;this.applyPaging();if(a!==true){this.fireEvent("datachanged",this);}}},isFiltered:function(){return this.snapshot&&this.snapshot!=(this.allData||this.data);},isPaging:function(e){var b=this.paramNames,f=e[b.start],a=e[b.limit];if((typeof f!="number")||(typeof a!="number")){delete this.start;delete this.limit;this.lastParams=e;return false;}this.start=f;this.limit=a;delete e[b.start];delete e[b.limit];var c=this.lastParams;this.lastParams=e;if(!this.proxy){return true;}if(!c){return false;}for(var d in e){if(e.hasOwnProperty(d)&&(e[d]!==c[d])){return false;}}for(d in c){if(c.hasOwnProperty(d)&&(e[d]!==c[d])){return false;}}return true;},applyPaging:function(){var h=this.start,b=this.limit;if((typeof h=="number")&&(typeof b=="number")){var e=this.data,f=new Ext.util.MixedCollection(e.allowFunctions,e.getKey);f.items=e.items.slice(h,h+b);f.keys=e.keys.slice(h,h+b);var a=f.length=f.items.length;var g={};for(var c=0;c<a;c++){var d=f.items[c];g[f.getKey(d)]=d;}f.map=g;this.allData=e;this.data=f;}}});Ext.ux.data.SimplePagingStore=function(a){Ext.ux.data.SimplePagingStore.superclass.constructor.call(this,Ext.apply(a,{reader:new Ext.data.ArrayReader(a)}));};Ext.extend(Ext.ux.data.SimplePagingStore,Ext.ux.data.PagingStore,{loadData:function(e,b){if(this.expandData===true){var d=[];for(var c=0,a=e.length;c<a;c++){d[d.length]=[e[c]];}e=d;}Ext.ux.data.SimplePagingStore.superclass.loadData.call(this,e,b);}});Ext.ux.data.JsonPagingStore=function(a){Ext.ux.data.JsonPagingStore.superclass.constructor.call(this,Ext.apply(a,{reader:new Ext.data.JsonReader(a)}));};Ext.extend(Ext.ux.data.JsonPagingStore,Ext.ux.data.PagingStore);